<UserControl x:Class="EloksalPro.View.StorehouseView"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
             xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors" 
             xmlns:viewModel="clr-namespace:EloksalPro.ViewModels" 
             xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core" >
    <UserControl.DataContext>
        <viewModel:StorehouseViewModel/>
    </UserControl.DataContext>
    <TabControl x:Name="tabControl" >
        <TabItem Header="Склад сырья" >
            <Border>
                <Border.Background>
                    <LinearGradientBrush StartPoint="1,0" EndPoint="1,2.9">
                        <GradientStop Color="{StaticResource primaryBackColor1}" Offset="1"/>
                        <GradientStop Color="{StaticResource primaryBackColor2}" Offset="0"/>
                    </LinearGradientBrush>
                </Border.Background>
                <Grid >
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="10"/>
                        <ColumnDefinition Width="300"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="30"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="10"/>
                    </Grid.RowDefinitions>
                    <TextBox  x:Name="txtidReceptionSpecification" Text="{Binding IdReception, UpdateSourceTrigger=PropertyChanged}" Grid.Row="0"  Grid.Column="1" Visibility="Hidden"/>
                    <TextBlock Grid.Row="0" Text="Список всех заказов:" FontSize="14" Margin="5" Background="Transparent" FontWeight="Medium" FontFamily="Montserrat" Foreground="White" Grid.ColumnSpan="3"/>
                    <dxg:GridControl  Grid.Row="1"  x:Name="gridControlReception"  Grid.Column="0"  Grid.ColumnSpan="3"  EnableSmartColumnsGeneration="True" ItemsSource="{Binding ReceptionMaterials}" Margin="5" AutoExpandAllGroups="False" >
                        <dxg:GridControl.ContextMenu>
                            <ContextMenu>
                                <MenuItem Header="Открыть детали заказа" Command="{Binding ShowCardReceptionDetailsCommand}" />
                                <MenuItem Header="Обновить данные" Command="{Binding RefreshAllProfileCommand}"/>
                                <MenuItem Header="Развернуть узлы" Click="expandNode"/>
                                <MenuItem Header="Свернуть узлы" Click="collapseNode" />
                            </ContextMenu>
                        </dxg:GridControl.ContextMenu>
                        <dxg:GridControl.View>
                            <dxg:TableView x:Name="tableViewReception" ShowTotalSummary="True" FontSize="14" AllowEditing="False" AutoWidth="True" NewItemRowPosition="Bottom" FontFamily="Times New Roman"  >
                                <dxg:TableView.FormatConditions>
                                    <dxg:FormatCondition Expression="Contains([Статус заказа], '0')" FieldName="Статус заказа" ApplyToRow="True">
                                        <dx:Format Background="#FFF2BAB8"/>
                                    </dxg:FormatCondition>
                                    <dxg:FormatCondition Expression="Contains([Статус заказа], '1')" FieldName="Статус заказа" ApplyToRow="True">
                                        <dx:Format Background="#FFD5F0C0"/>
                                    </dxg:FormatCondition>
                                </dxg:TableView.FormatConditions>
                                <dxg:TableView.ColumnHeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding}" TextWrapping="Wrap"/>
                                    </DataTemplate>
                                </dxg:TableView.ColumnHeaderTemplate>
                                <dxg:TableView.RowStyle>
                                    <Style>
                                        <Setter Property="TextElement.Foreground" Value="Black"/>
                                    </Style>
                                </dxg:TableView.RowStyle>
                            </dxg:TableView>
                        </dxg:GridControl.View>
                        <dxg:GridColumn FieldName="Id" Header="Id" Visible="False"/>
                        <dxg:GridColumn FieldName="DateSpecification" Header="Дата заказа" Width="80" />
                        <dxg:GridColumn FieldName="NumberSpecification" Header="Номер заказа" Width="80" />
                        <dxg:GridColumn FieldName="ClientName" Header="Наименование заказчика" Width="120" />
                        <dxg:GridColumn FieldName="DateReception" Header="Дата приема сырья" Width="80" />
                        <dxg:GridColumn FieldName="TotalSumWeight" Header="Общий вес" Width="70" />
                        <dxg:GridColumn FieldName="WeightShippedProduction" Header="Отгруженный вес" Width="70" />
                        <dxg:GridColumn FieldName="WorkingShift" Header="Смена" Width="60" />
                        <dxg:GridColumn FieldName="FullName" Header="Принял ФИО" Width="90" />
                        <dxg:GridColumn FieldName="Annotation" Header="Примечание" />
                        <dxg:GridColumn FieldName="Месяц" UnboundType="Integer" UnboundExpression="GetMonth([DateSpecification])" SortOrder="Ascending" GroupIndex="1"/>
                        <dxg:GridColumn FieldName="Год" UnboundType="Integer" UnboundExpression="GetYear([DateSpecification])" SortOrder="Descending" GroupIndex="0" />
                        <dxg:GridColumn FieldName="Статус заказа" UnboundExpression="Iif([DateReception] = null, '0: Не принято', '1: Принято')" UnboundType="String" SortOrder="Ascending" GroupIndex="2" />
                    </dxg:GridControl>
                </Grid>
            </Border>
        </TabItem>
        <TabItem Header="Упаковка профиля">
            <Border>
                <Border.Background>
                    <LinearGradientBrush StartPoint="1,0" EndPoint="1,2.9">
                        <GradientStop Color="{StaticResource primaryBackColor1}" Offset="1"/>
                        <GradientStop Color="{StaticResource primaryBackColor2}" Offset="0"/>
                    </LinearGradientBrush>
                </Border.Background>
                <Grid >
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="340"/>
                        <ColumnDefinition Width="497.5"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="10"/>
                        <RowDefinition Height="30"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="10"/>
                    </Grid.RowDefinitions>
                    <TextBox  x:Name="txtIdPackingAluminumProfileSummary" Text="{Binding IdPackingSummary, UpdateSourceTrigger=PropertyChanged}"  Grid.Row="0" Grid.Column="2" Visibility="Hidden" Margin="0.5,0,-1,0" />
                    <TextBox  x:Name="txtBasketSummary" Text="{Binding BasketNumber, UpdateSourceTrigger=PropertyChanged}"  Grid.Row="0" Grid.Column="2" Visibility="Hidden" Margin="0.5,0,-1,0" />
                    <TextBlock Grid.Row="1" Text="Данные по упаковке профиля:" FontSize="14" Margin="5,5,4.5,5" Background="Transparent" FontWeight="Medium" FontFamily="Montserrat" Foreground="White" Grid.ColumnSpan="2" />
                    <dxg:GridControl  Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="3" x:Name="gridControlPackingAluminumProfileSummary" EnableSmartColumnsGeneration="True" ItemsSource="{Binding PackingAluminumProfileSummaryTable}" Margin="5" >
                        <dxg:GridControl.ContextMenu>
                            <ContextMenu>
                                <!--<MenuItem Header="Открыть карту" Command="{Binding ShowPackingProfileSummaryCommand}" />-->
                                <MenuItem Header="Обновить данные" Command="{Binding  RefreshAllProfileCommand}"/>
                                <MenuItem Header="Печать этикетки" Command="{Binding  ShowPrintProfileCommand}"/>
                            </ContextMenu>
                        </dxg:GridControl.ContextMenu>
                        <dxg:GridControl.TotalSummary>
                            <dxg:GridSummaryItem FieldName="QuantityProducedProfile" ShowInColumn="QuantityProducedProfile" SummaryType="Sum" FrameworkElement.FlowDirection="RightToLeft" DisplayFormat="#,#"/>
                            <dxg:GridSummaryItem FieldName="GeneralQuantityProducedProfile" ShowInColumn="GeneralQuantityProducedProfile" SummaryType="Sum" FrameworkElement.FlowDirection="RightToLeft"  DisplayFormat="#,#.00"/>
                            <dxg:GridSummaryItem FieldName="GeneralAreaProducedProfile" ShowInColumn="GeneralAreaProducedProfile" SummaryType="Sum" FrameworkElement.FlowDirection="RightToLeft"  DisplayFormat="#,#.00"/>
                            <dxg:GridSummaryItem FieldName="QuantityDefectiveProfile" ShowInColumn="QuantityDefectiveProfile" SummaryType="Sum" FrameworkElement.FlowDirection="RightToLeft"  DisplayFormat="#,#"/>
                            <dxg:GridSummaryItem FieldName="GeneralQuantityDefectiveProfile" ShowInColumn="GeneralQuantityDefectiveProfile" SummaryType="Sum" FrameworkElement.FlowDirection="RightToLeft"  DisplayFormat="#,#.00"/>
                            <dxg:GridSummaryItem FieldName="GeneralAreaDefectiveProfile" ShowInColumn="GeneralAreaDefectiveProfile" SummaryType="Sum" FrameworkElement.FlowDirection="RightToLeft"  DisplayFormat="#,#.00"/>
                        </dxg:GridControl.TotalSummary>
                        <dxg:GridColumn FieldName="Id" Header="Id" Visible="False"/>
                        <dxg:GridColumn FieldName="NumberPackingAluminumProfile" Header="Номер упаковки" Width="80" />
                        <dxg:GridColumn FieldName="Date" Header="Дата" Width="80"/>
                        <dxg:GridColumn FieldName="Shift" Header="Смена" Width="80" Visible="False"/>
                        <dxg:GridColumn FieldName="BasketNumber" Header="Номер паллета" Width="80"/>
                        <dxg:GridColumn FieldName="ClientName" Header="Клиент"  AllowEditing="False"/>
                        <dxg:GridColumn FieldName="NumberSpecification" Header="Номер заказа"  AllowEditing="False" Width="80"/>
                        <dxg:GridColumn FieldName="EloksalNoCommercial" Header="Коммерческий номер"  AllowEditing="False"/>
                        <dxg:GridColumn FieldName="NomenclatureProfile" Header="Номенклатура профиля"  AllowEditing="False" Width="160"/>
                        <dxg:GridColumn FieldName="LenghtProfile" Header="Длина профиля"  AllowEditing="False" Width="60"/>
                        <dxg:GridColumn FieldName="WeightMeter" Header="Вес профиля"  AllowEditing="False" Width="60"/>
                        <dxg:GridColumn FieldName="QuantityProducedProfile" Header="Кол-во произ. профиля, шт"  AllowEditing="False"/>
                        <dxg:GridColumn FieldName="GeneralQuantityProducedProfile" Header="Вес произ. профиля, кг"  AllowEditing="False" Visible="False"/>
                        <dxg:GridColumn FieldName="GeneralAreaProducedProfile" Header="Площадь произ. профиля, м2" AllowEditing="False" Visible="False" />
                        <dxg:GridColumn FieldName="QuantityDefectiveProfile" Header="Количество отбрак. профиля, шт" AllowEditing="False"/>
                        <dxg:GridColumn FieldName="GeneralQuantityDefectiveProfile" Header="Вес отбрак. профиля, кг" AllowEditing="False" Visible="False"/>
                        <dxg:GridColumn FieldName="GeneralAreaDefectiveProfile" Header="Площадь отбрак. профиля, м2" AllowEditing="False" Visible="False"/>
                        <dxg:GridColumn FieldName="Месяц" UnboundType="Integer" UnboundExpression="GetMonth([Date])" SortOrder="Ascending" GroupIndex="0"/>
                        <dxg:GridColumn FieldName="Год" UnboundType="Integer" UnboundExpression="GetYear([Date])" SortOrder="Descending" GroupIndex="0"/>

                        <dxg:GridControl.View>
                            <dxg:TableView x:Name="tableViewPackingAluminumProfileSummary" ShowTotalSummary="True" FontSize="12" AllowEditing="False" AutoWidth="True" NewItemRowPosition="Bottom" FontFamily="Times New Roman"  >
                                <dxg:TableView.ColumnHeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding}" TextWrapping="Wrap"/>
                                    </DataTemplate>
                                </dxg:TableView.ColumnHeaderTemplate>
                                <dxg:TableView.RowStyle>
                                    <Style>
                                        <Setter Property="TextElement.Foreground" Value="Black"/>
                                    </Style>
                                </dxg:TableView.RowStyle>
                            </dxg:TableView>
                        </dxg:GridControl.View>
                    </dxg:GridControl>
                </Grid >
            </Border>
        </TabItem>
        <TabItem Header="Отгрузка алюминиевого профиля">
            <Border>
                <Border.Background>
                    <LinearGradientBrush StartPoint="1,0" EndPoint="1,2.9">
                        <GradientStop Color="{StaticResource primaryBackColor1}" Offset="1"/>
                        <GradientStop Color="{StaticResource primaryBackColor2}" Offset="0"/>
                    </LinearGradientBrush>
                </Border.Background>
                <Grid >
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="285"/>
                        <ColumnDefinition Width="399"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="60"/>
                        <RowDefinition Height="10"/>
                        <RowDefinition Height="30"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="10"/>
                    </Grid.RowDefinitions>
                    <Button Grid.Row="0" Grid.Column="1" Margin="10,10,0,10"
						Command="{Binding ShowNewConsumptionWarehouseProfileCommand}"
						Content="Создать новый отгрузочный лист(старый)" HorizontalAlignment="Left"  
						Style="{StaticResource controlButtonLightGray}" Grid.ColumnSpan="2" />
                    <Button Grid.Row="0" Grid.Column="0" Margin="10,10,0,10"
						Command="{Binding ShowNewShipmentByPalletsProfileCommand}"
						Content="Создание отгрузочного листа (новый)" HorizontalAlignment="Left"  
						Style="{StaticResource controlButtonLightGray}" Grid.ColumnSpan="2"/>

                    <TextBox  x:Name="txtIdConsumptionWarehouse" Text="{Binding IdConsumptionWarehouse, UpdateSourceTrigger=PropertyChanged}"  Grid.Row="0" Grid.Column="2" Visibility="Hidden" />
                    <TextBlock Grid.Row="2" Text="Данные профиля на складе по сменам:" FontSize="14" Margin="5" Background="Transparent" FontWeight="Medium" FontFamily="Montserrat" Foreground="White" Grid.ColumnSpan="2" />
                    <dxg:GridControl  Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="3" x:Name="gridControlConsumptionWarehouse" EnableSmartColumnsGeneration="True" ItemsSource="{Binding ProfileConsumptionWarehouseGeneral}" Margin="5" >
                        <dxg:GridControl.ContextMenu>
                            <ContextMenu>
                                <MenuItem Header="Открыть карту" Command="{Binding  ShowConsumptionWarehouseProfileCommand}" />
                                <MenuItem Header="Обновить данные" Command="{Binding  RefreshAllProfileCommand}"/>
                                <MenuItem Header="Удалить отгрузочный лист" Command="{Binding  RemoveCommand}"/>
                                <MenuItem Header="Развернуть узлы" Click="expandNode"/>
                                <MenuItem Header="Свернуть узлы" Click="collapseNode" />
                            </ContextMenu>
                        </dxg:GridControl.ContextMenu>
                        <dxg:GridColumn FieldName="Id" Header="Id" Visible="False"/>
                        <dxg:GridColumn FieldName="NumberProfileConsumptionWarehouse" Header="Номер отгрузочного листа" />
                        <dxg:GridColumn FieldName="ClientName" Header="Наименование клиента" />
                        <dxg:GridColumn FieldName="Date" Header="Дата"/>
                        <dxg:GridColumn FieldName="Shift" Header="Смена" />
                        <dxg:GridColumn FieldName="WeightProducedProfile" Header="Общий вес, кг" />
                        <dxg:GridColumn FieldName="GeneralAreaProducedProfile" Header="Общая площадь,м2" />
                        <!--<dxg:GridColumn FieldName="WeightDefectedProfile" Header="Общий вес брака, кг" />-->
                        <!--dxg:GridColumn FieldName="GeneralAreaDefectiveProfile" Header="Общая площадь бракованного профиля,м2" />-->
                        <dxg:GridColumn FieldName="Employee" Header="Сотрудник"/>
                        <dxg:GridColumn FieldName="Annotation" Header="Примечание"/>
                        <dxg:GridColumn FieldName="Месяц" UnboundType="Integer" UnboundExpression="GetMonth([Date])" SortOrder="Ascending" GroupIndex="0"/>
                        <dxg:GridColumn FieldName="Год" UnboundType="Integer" UnboundExpression="GetYear([Date])" SortOrder="Descending" GroupIndex="0"/>

                        <dxg:GridControl.View>
                            <dxg:TableView x:Name="tableViewConsumptionWarehouse" ShowTotalSummary="True" FontSize="12" AllowEditing="False" AutoWidth="True" NewItemRowPosition="Bottom" FontFamily="Times New Roman"  >
                                <dxg:TableView.ColumnHeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding}" TextWrapping="Wrap"/>
                                    </DataTemplate>
                                </dxg:TableView.ColumnHeaderTemplate>
                                <dxg:TableView.RowStyle>
                                    <Style>
                                        <Setter Property="TextElement.Foreground" Value="Black"/>
                                    </Style>
                                </dxg:TableView.RowStyle>
                            </dxg:TableView>
                        </dxg:GridControl.View>
                    </dxg:GridControl>
                </Grid >
            </Border>
        </TabItem>
    </TabControl>
</UserControl>
